# Consensus工具 - 多模型观点收集

**从多个AI模型获得关于技术提案和决策的多样化专家意见**

`consensus`工具编排多个AI模型为您的提案提供多样化观点，通过支持/反对分析和多模型专家意见实现结构化决策制定。

## 思考模式

**默认为`medium`（8,192 tokens）。** 对于复杂架构决策使用`high`，对于需要全面分析的关键战略选择使用`max`。

## 模型推荐

Consensus工具默认使用扩展推理模型，使其成为受益于多重观点和深度分析的复杂决策场景的理想选择。

## 如何工作

consensus工具编排多个AI模型为您的提案提供多样化观点：

1. **分配立场**：每个模型可以采取特定观点（支持、批评或中立）
2. **收集意见**：模型从其分配的观点分析您的提案，具有内置的常识护栏
3. **综合结果**：Claude将所有观点合并为平衡的建议
4. **自然语言**：使用简单描述如"supportive"、"critical"或"against" - 工具自动处理同义词

## 示例提示

**支持/反对分析：**
```
使用zen consensus，flash采取支持立场，pro持批评态度，评估我们是否应该从REST迁移到GraphQL API
```

**多模型技术决策：**
```
从o3、flash和pro获得关于我们新认证架构的共识。让o3专注于安全影响，flash关注实施速度，pro保持中立进行整体评估
```

**自然语言立场分配：**
```
使用consensus工具，gemini"支持"提案，grok"反对"，辩论我们是否应该采用微服务架构
```

```
我想开发模块X和Y，不确定哪个对我应用的用户更受欢迎。
从gemini获得共识，支持实施X的想法，grok反对，flash保持中立
```

## 关键功能

- **立场引导**：为每个模型分配特定观点（支持/反对/中立），具有智能同义词处理
- **自定义立场提示**：为每个模型如何处理分析提供具体指导
- **道德护栏**：无论分配的立场如何，模型都会拒绝支持真正糟糕的想法
- **未知立场处理**：无效立场自动默认为中立并发出警告
- **自然语言支持**：使用"supportive"、"critical"、"oppose"、"favor"等术语 - 全部智能处理
- **顺序处理**：可靠执行，避免MCP协议问题
- **关注领域**：指定要强调的特定方面（如'security'、'performance'、'user experience'）
- **文件上下文支持**：包含相关文件以进行明智决策
- **图像支持**：分析架构图、UI模型或设计文档
- **对话延续**：在之前的共识分析基础上构建额外轮次
- **网络搜索能力**：用当前最佳实践和文档增强分析

## 工具参数

- `prompt`：要分析的提案或决策的详细描述（必需）
- `models`：带有可选立场和自定义指令的模型配置列表（必需）
- `files`：用于明智分析的上下文文件（绝对路径）
- `images`：如图表或模型的视觉参考（绝对路径）
- `focus_areas`：要强调的具体方面
- `temperature`：控制一致性（默认：0.2用于稳定共识）
- `thinking_mode`：分析深度（minimal/low/medium/high/max）
- `use_websearch`：启用研究以增强分析（默认：true）
- `continuation_id`：继续之前的共识讨论

## 模型配置示例

**基本支持/反对：**
```json
[
    {"model": "flash", "stance": "for"},
    {"model": "pro", "stance": "against"}
]
```

**自定义立场指令：**
```json
[
    {"model": "o3", "stance": "for", "stance_prompt": "专注于实施优势和用户价值"},
    {"model": "flash", "stance": "against", "stance_prompt": "识别潜在风险和技术挑战"}
]
```

**中立分析：**
```json
[
    {"model": "pro", "stance": "neutral"},
    {"model": "o3", "stance": "neutral"}
]
```

## 使用示例

**架构决策：**
```
"从pro和o3获得关于我们电商平台使用微服务vs单体的共识"
```

**技术迁移：**
```
"使用consensus，flash支持，pro反对，评估从MySQL迁移到PostgreSQL"
```

**功能优先级：**
```
"从多个模型获得关于优先考虑移动应用vs网页仪表板开发的共识"
```

**带视觉上下文：**
```
"使用consensus评估这个新UI设计模型 - 让flash支持它，pro持批评态度"
```

## 最佳实践

- **提供详细上下文**：包含项目约束、要求和背景
- **使用平衡立场**：混合支持和批评观点以进行彻底分析
- **指定关注领域**：指导模型强调相关方面（安全、性能等）
- **包含相关文件**：为上下文提供代码、文档或规范
- **建立在讨论基础上**：使用延续进行后续分析和细化
- **利用视觉上下文**：在相关时包含图表、模型或设计文档

## 道德护栏

consensus工具包含内置的道德保障：
- 无论分配的立场如何，模型都不会支持真正有害的提案
- 未知或无效立场自动默认为中立
- 对潜在有问题的请求发出警告消息
- 专注于建设性的技术决策制定

## 何时使用Consensus与其他工具

- **使用`consensus`**：多观点分析、结构化辩论、重大技术决策
- **使用`chat`**：开放式讨论和头脑风暴
- **使用`thinkdeep`**：用更深推理扩展具体分析
- **使用`analyze`**：理解现有系统而不进行辩论
