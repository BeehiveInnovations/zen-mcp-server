# DocGen工具 - 全面文档生成

**通过工作流驱动调查生成带有复杂性分析的全面文档**

`docgen`工具通过分析您的代码结构、理解函数复杂性，并记录开发人员需要了解的陷阱和意外行为来创建彻底的文档。此工作流工具指导Claude通过多个步骤系统调查代码功能、架构模式和文档需求，然后生成带有复杂性分析和调用流信息的全面文档。

## 工作流如何运作

docgen工具实现了**结构化工作流**以进行全面文档生成：

**调查阶段（Claude主导）：**
1. **步骤1（发现）**：Claude发现所有需要文档的文件并报告确切数量
2. **步骤2+（文档）**：Claude逐一记录文件，进行完整覆盖验证
3. **整个过程**：Claude跟踪带计数器的进度并强制现代文档样式
4. **完成**：仅当所有文件都已记录时（num_files_documented = total_files_to_document）

**文档生成阶段：**
在Claude完成调查后：
- 具有样式一致性的完整文档策略
- 带复杂性分析的函数/方法文档
- 调用流和依赖文档
- 陷阱和意外行为文档
- 遵循项目标准的最终精美文档

这个工作流确保在文档生成之前进行有条理的分析，产生更全面和有价值的文档。

## 模型推荐

文档生成在分析模型（如Gemini Pro或O3）上表现出色，它们可以理解复杂的代码关系，识别非明显行为，并生成覆盖陷阱和边缘情况的彻底文档。大上下文窗口和分析推理的结合使得能够生成有助于防止集成问题和开发人员困惑的文档。

## 示例提示

**基本用法：**
```
"使用zen为UserManager类生成文档"
"用gemini pro生成带复杂性分析的认证模块文档"
"为src/payment_processor.py中的所有方法添加全面文档"
```

## 关键功能

- **系统化逐文件方法** - 带进度跟踪和验证的完整文档
- **现代文档样式** - 强制Objective-C/Swift使用///，Java/JavaScript使用/** */等
- **复杂性分析** - 算法的Big O表示法和性能特征
- **调用流文档** - 依赖关系和方法关系
- **基于计数器的完成** - 防止在所有文件记录前停止
- **大文件处理** - 系统化逐部分文档以获得全面覆盖
- **最终验证扫描** - 强制检查确保不遗漏函数
- **错误跟踪** - 在不改变逻辑的情况下浮现代码问题
- **配置参数** - 控制复杂性分析、调用流和内联注释

## 工具参数

**工作流参数（在逐步过程中使用）：**
- `step`：当前步骤描述 - 发现阶段（步骤1）或文档阶段（步骤2+）
- `step_number`：文档序列中的当前步骤号（必需）
- `total_steps`：动态计算为1 + total_files_to_document
- `next_step_required`：是否需要另一个步骤
- `findings`：关于代码结构和文档需求的发现（必需）
- `relevant_files`：当前步骤中主动记录的文件
- `num_files_documented`：跟踪已完成文件的计数器（必需）
- `total_files_to_document`：需要文档的文件总数（必需）

**配置参数（必需字段）：**
- `document_complexity`：包含Big O复杂性分析（默认：true）
- `document_flow`：包含调用流和依赖信息（默认：true）
- `update_existing`：当不正确/不完整时更新现有文档（默认：true）
- `comments_on_complex_logic`：为复杂算法步骤添加内联注释（默认：true）

## 使用示例

**类文档：**
```
"为PaymentProcessor类生成包含复杂性分析的全面文档"
```

**模块文档：**
```
"为认证模块中的所有函数生成带调用流信息的文档"
```

**API文档：**
```
"为api/users.py中的REST API端点创建带参数陷阱的文档"
```

**算法文档：**
```
"为utils/sort.py中的排序算法生成带Big O分析和边缘情况的文档"
```

**库文档：**
```
"为实用程序库添加带使用示例和警告的全面文档"
```

## 文档标准

**函数/方法文档：**
- 参数类型和描述
- 带类型的返回值文档
- 算法复杂性分析（Big O表示法）
- 调用流和依赖信息
- 目的和行为解释
- 异常类型和条件

**陷阱和边缘情况：**
- 产生意外结果的参数组合
- 对全局状态或环境的隐藏依赖
- 序列很重要的顺序依赖操作
- 性能影响和瓶颈
- 线程安全考虑
- 平台特定行为差异

**代码质量文档：**
- 复杂逻辑的内联注释
- 设计模式解释
- 架构决策理由
- 使用示例和最佳实践

## 生成的文档功能

**复杂性分析：**
- 时间复杂性（Big O表示法）
- 相关时的空间复杂性
- 最坏情况、平均情况和最佳情况场景
- 性能特征和瓶颈

**调用流文档：**
- 此代码调用哪些方法/函数
- 哪些方法/函数调用此代码
- 关键依赖和交互
- 副作用和状态修改
- 通过函数的数据流

**陷阱文档：**
- 非明显参数交互
- 隐藏状态依赖
- 静默失败条件
- 资源管理要求
- 版本兼容性问题
- 平台特定行为

## 增量文档方法

**关键优势：**
- **即时价值交付** - 代码立即变得更可维护
- **迭代改进** - 跨多个分析轮次的模式识别
- **质量验证** - 在工作流期间测试文档有效性
- **减少认知负载** - 一次专注于一个函数/方法

**工作流过程：**
1. **分析和文档**：检查每个函数并立即添加文档
2. **继续分析**：移动到下一个函数，同时建立理解
3. **完善和标准化**：审查和改进之前添加的文档

## 语言支持

**现代文档样式强制：**
- **Python**：带类型提示的三重引号文档字符串
- **Objective-C**：/// 注释
- **Swift**：/// 注释
- **JavaScript/TypeScript**：/** */ JSDoc样式
- **Java**：/** */ Javadoc样式
- **C#**：/// XML文档注释
- **C/C++**：/// 用于文档注释
- **Go**：函数/类型上方的// 注释
- **Rust**：/// 用于文档注释

## 文档质量功能

**全面覆盖：**
- 所有公共方法和函数
- 需要解释的复杂私有方法
- 类和模块级文档
- 配置和设置要求

**以开发者为中心：**
- 非明显行为的清晰解释
- 复杂API的使用示例
- 常见陷阱的警告
- 集成指导和最佳实践

**可维护格式：**
- 一致的文档样式
- 适当的详细级别
- 交叉引用和链接
- 版本和兼容性说明

## 最佳实践

- **使用系统方法**：工具现在记录所有文件，带进度跟踪和验证
- **信任计数器**：工具防止在所有文件记录前过早完成
- **处理大文件**：工具自动以系统化部分处理大文件
- **强制现代样式**：工具确保每种语言的正确文档样式
- **配置很重要**：启用复杂性分析和调用流以获得全面文档
- **错误跟踪**：工具在不改变代码的情况下浮现问题 - 完成后审查发现

## 何时使用DocGen与其他工具

- **使用`docgen`**：创建全面文档、添加缺失文档、改进现有文档
- **使用`analyze`**：理解代码结构而不生成文档
- **使用`codereview`**：审查包括文档完整性在内的代码质量
- **使用`refactor`**：在文档前重构代码（更清洁的代码 = 更好的文档）
